$(document).ready(function(){$.ajax({dataType:"json",url:"../php/DropDown.php",success:function load(result){populateDropDowns(result);}});});function populateDropDowns(results){var getUrlParameter=function getUrlParameter(sParam){var sPageURL=decodeURIComponent(window.location.search.substring(1)),sURLVariables=sPageURL.split('&'),sParameterName,i;for(i=0;i<sURLVariables.length;i++){sParameterName=sURLVariables[i].split('=');if(sParameterName[0]===sParam){return sParameterName[1]===undefined?true:sParameterName[1];}}};var PBIIDFromURL=getUrlParameter("PBIId");var sprint=$("#sprints");var priority=$("#pbiPriority");var state=$("#pbiState");var phpSprintValues=[];var phpPriorityValues=[];var phpStateValues=[];$.each(results,function(key,value){phpSprintValues=value[0];phpPriorityValues=value[1];phpStateValues=value[2];});$.each(phpSprintValues,function(key,value){sprint.append('<option value="'+value.IterationName+'">'+value.IterationName+'</option>')})
$.each(phpSprintValues,function(key,value){$("#pbiIteration").append('<option value="'+value.IterationName+'">'+value.IterationName+'</option>')})
$.each(phpPriorityValues,function(key,value){priority.append('<option value="'+value.Priority+'">'+value.Priority+'</option>')})
$.each(phpPriorityValues,function(key,value){$("#pbiDetailPriority").append('<option value="'+value.Priority+'">'+value.Priority+'</option>')})
$.each(phpStateValues,function(key,value){state.append('<option value="'+value.State+'">'+value.State+'</option>')})
$.each(phpStateValues,function(key,value){$("#pbiDetailState").append('<option value="'+value.State+'">'+value.State+'</option>')})
if(PBIIDFromURL!=null){$.ajax({type:"POST",url:"../php/PBIDetails.php",data:{postedPBIID:PBIIDFromURL,},dataType:"json",success:function createPBIDetails(pbiData){PBIDetails(pbiData);},error:function(){console.log('error')}});};$("#pbiSearch").click(function(e){e.preventDefault();$.ajax({type:"POST",url:"../php/SearchPBIs.php",data:{postedSprint:sprint.val(),postedPriority:priority.val(),postedState:state.val()},dataType:"json",success:function createPBITable(pbis){PBI(pbis);},error:function(){console.log('error')}});});return false;function PBI(results){var pbiID=[];var pbiTitle=[];var table=document.getElementById('pBIResultstable')
var rows=table.getElementsByTagName('tr').length;var clickedPBIID;if(rows>1){for(i=rows-1;i>0;i--){table.deleteRow(i);}}else{}$.each(results,function(key,value){var a=value.pbiId;var b=value.pbiTitle;pbiID.push(a);pbiTitle.push(b);});for(i=0;i<results.length;i++){$("#pBIResultstable").append('<tr class="PBI">'+'<td>'+pbiID[i]+'</td>'+'<td>'+pbiTitle[i]+'</td>'+'</tr>');};$(".PBI").click(function(e){e.preventDefault();clickedPBIID=e.target.parentNode.firstChild.textContent;$.ajax({type:"POST",url:"../php/PBIDetails.php",data:{postedPBIID:clickedPBIID,},dataType:"json",success:function createPBIDetails(pbiData){PBIDetails(pbiData);},error:function(){console.log('error')}});});return false;};function PBIDetails(results){var pbiIDField=document.getElementById("pbiID");var pbiTitleField=document.getElementById("pbiTitle");var pbiDescField=document.getElementById("pbiDescription");var pbiEffortField=document.getElementById("pbiEffort");var pbiPriorityField=document.getElementById("pbiDetailPriority");var pbiStateField=document.getElementById("pbiDetailState");var pbiIterationField=document.getElementById("pbiIteration");var pbiProjectField=document.getElementById("pbiProject");$('#pbiDetails').velocity({opacity:1},{duration:200});$('#pbiDetailsButton').show();$('#pbiDetailsButton').css("visibility","visible");$('#pbiDetailsButton').velocity({opacity:1},{duration:0});$('#deletePbiButton').show();$('#deletePbiButton').css("visibility","visible");$('#deletePbiButton').velocity({opacity:1},{duration:0});$('#createPBI').hide();$('#createPBI').css("visibility","hidden");$('#createPBI').velocity({opacity:0},{duration:0});$.each(results,function(key,value){pbiIDField.value=value.pbiId;pbiTitleField.value=value.pbiTitle;pbiDescField.value=value.pbiDesc;pbiEffortField.value=value.pbiEff;pbiPriorityField.value=value.priority;pbiStateField.value=value.state;pbiIterationField.value=value.itName;})};};