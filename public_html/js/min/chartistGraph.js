$(document).ready(function(){$.ajax({dataType:"json",url:"./php/GraphData.php",success:function createArray(result){createGraph(result);}});});function createGraph(phpArray){var xlab=[];var xlabBar=[];var totalEffort=[];var remainingEffort=[];var effortcommitted=[];var noOfSprints=0;$.each(phpArray,function(key,value){var label=value.itName;xlab.push(label);xlabBar.push(label);noOfSprints++;});$.each(phpArray,function(key,value){if(!value.effTot){}else{var tEff=value.effTot;totalEffort.push(tEff);}});$.each(phpArray,function(key,value){if(!value.effRem){}else{var rEff=value.effRem;remainingEffort.push(rEff);}});$.each(phpArray,function(key,value){var comeff=value.effCom;effortcommitted.push(comeff);});var data={labels:xlab,series:[totalEffort,remainingEffort]};var options={low:0,axisY:{onlyInteger:true}};var responsiveOptions=[['screen and (min-width: 501px) and (max-width: 1024px)',{axisX:{labelInterpolationFnc:function(value){var tInString=value.lastIndexOf('t');var endofString=value.length;var sprintNo=value.slice(tInString+1,endofString);return sprintNo;}}}],['screen and (max-width: 500px)',{axisX:{labelInterpolationFnc:function(value){var tInString=value.lastIndexOf('t');var endofString=value.length;var sprintNo=value.slice(tInString+1,endofString);return sprintNo;}}}]];var responsiveOptionsForMoreThanTenSprints=[['screen and (min-width: 501px) and (max-width: 5000px)',{axisX:{labelInterpolationFnc:function(value){var tInString=value.lastIndexOf('t');var endofString=value.length;var sprintNo='S '+value.slice(tInString+1,endofString);return sprintNo;}}}],['screen and (max-width: 500px)',{axisX:{labelInterpolationFnc:function(value){var tInString=value.lastIndexOf('t');var endofString=value.length;var sprintNo=value.slice(tInString+1,endofString);return sprintNo;}}}]];if(noOfSprints>10){var chart=new Chartist.Line('#chart1',data,options,responsiveOptionsForMoreThanTenSprints);}else{var chart=new Chartist.Line('#chart1',data,options,responsiveOptions);}var seq=0,delays=10,durations=1500;chart.on('created',function(){seq=0;});chart.on('draw',function(data){seq++;if(data.type==='line'){data.element.animate({opacity:{begin:seq*delays+1000,dur:durations,from:0,to:1}});}else if(data.type==='label'&&data.axis==='x'){data.element.animate({y:{begin:seq*delays,dur:durations,from:data.y+100,to:data.y,easing:'easeOutQuart'}});}else if(data.type==='label'&&data.axis==='y'){data.element.animate({x:{begin:seq*delays,dur:durations,from:data.x-50,to:data.x,easing:'easeOutQuart'}});}else if(data.type==='point'){data.element.animate({x1:{begin:seq*delays,dur:durations,from:data.x-50,to:data.x,easing:'easeOutQuart'},x2:{begin:seq*delays,dur:durations,from:data.x-50,to:data.x,easing:'easeOutQuart'},opacity:{begin:seq*delays,dur:durations,from:0,to:1,easing:'easeOutQuart'}});}});var $chart=$('#chart1');var $toolTip=$chart.append('<div class="tooltip"></div>').find('.tooltip').hide();$chart.on('mouseenter','.ct-point',function(){var $point=$(this),value=$point.attr('ct:value')
if($point.parent().attr('class')=='ct-series ct-series-a'){seriesName='Total Effort';$toolTip.css("border","1px solid #4eabec")}else if($point.parent().attr('class')=='ct-series ct-series-b'){seriesName='Remaining Effort';$toolTip.css("border","1px solid #ec704e")}else{seriesName='Effort';}$toolTip.html(seriesName+'<br>'+value).show();$point.click(function(e){var value=$point.attr('ct:value')
var arrayPosition=remainingEffort.indexOf(value)
var relatedSprintNo=xlab[arrayPosition]
location="./dashboard/sprints.php?SprintNo="+relatedSprintNo.trim()})});$chart.on('mouseleave','.ct-point',function(){$toolTip.hide();});$chart.on('mousemove',function(event){$toolTip.css({left:(event.offsetX||event.originalEvent.layerX)-$toolTip.width()/2-10,top:(event.offsetY||event.originalEvent.layerY)-$toolTip.height()-40});});var barchart=new Chartist.Bar('#chart2',{labels:xlabBar.splice(xlabBar.length-6,6),series:[effortcommitted.splice(effortcommitted.length-6,6)]},options,responsiveOptionsForMoreThanTenSprints);barchart.on('created',function(){seq=0;});barchart.on('draw',function(data){seq++;if(data.type==='bar'){data.element.animate({opacity:{begin:seq*delays,dur:1000,from:0,to:1},});}});};